#! /bin/bash

#echo "Copy plugin files"
aws s3 cp ../release/cricket-api.zip s3://litzscore/release/wordpress/plugin/cricket-api.zip

#echo "Copy static files" 
cd ../plugin/cricket-api
aws s3 cp views/rca-cricket.css s3://litzscore/release/wordpress/css/rca-cricket.css
aws s3 cp views/rca-cricket-angular.js s3://litzscore/release/wordpress/js/rca-cricket-angular.js


# make sure this command is enabled by 'aws configure set preview.cloudfront true'
cd ../../scripts/

read -r -p "Wish to invalidate on cloudfront? [y/N] " response
if [[ $response =~ ^([yY][eE][sS]|[yY])$ ]]
then
  echo "Invalidating files on Cloudfront"
  
  aws cloudfront create-invalidation --cli-input-json file://cf-invalid-input.json
  
  echo "Call the following cmd, to wait and check status of invalidation"
  echo "aws cloudfront wait invalidation-completed --distribution-id E3TI44SJKXQYB5 --id ID_YOU_GOT_ABOVE"
  echo "aws cloudfront get-invalidation --distribution-id E3TI44SJKXQYB5 --id ID_YOU_GOT_ABOVE"
fi

